import java.util.function.Supplier

apply plugin: 'org.screamingsandals.nms'

sourceSets.main.java.srcDirs += 'src/generated/java'

// after any changes, please run generateNmsComponents task

nmsGen {
    basePackage = "org.screamingsandals.lib.nms.accessors"
    sourceSet = "src/generated/java"
    cleanOnRebuild = true

    var ChatComponent = reqClass('net.minecraft.network.chat.Component')
        .reqMethod('searge:func_150254_d') // get legacy string

    reqClass('net.minecraft.world.entity.EntityType')
        .reqMethod('byString', String) // 1.14+
        .reqMethod('searge:func_200713_a', String) // 1.13.X
        .reqField('searge:field_191308_b') // 1.11 - 1.12.2
        .reqField('searge:field_75624_e') // <= 1.10.2

    reqClass('net.minecraft.core.Registry')
        .reqField('ENTITY_TYPE')
        .reqMethod('getId', Object)

    reqClass('net.minecraft.core.MappedRegistry')
        .reqMethod('searge:func_148757_b', Object)

    var Entity = reqClass('net.minecraft.world.entity.Entity')
        .reqMethod('getEntityData') // DataWatcher
        .reqMethod('getCommandSenderWorld') // world
        .reqMethod('getX')
        .reqMethod('getY')
        .reqMethod('getZ')
        .reqMethod('getYRot')
        .reqMethod('getXRot')
        .reqMethod('getType')
        .reqMethod('getId')
        .reqMethod('setNoGravity', boolean)
        .reqMethod('isNoGravity')
        .reqMethod('setOnGround', boolean)
        .reqMethod('isOnGround')
        .reqMethod('getUUID')
        .reqMethod('setCustomNameVisible', boolean)
        .reqMethod('isCustomNameVisible')
        .reqMethod('setInvisible', boolean)
        .reqMethod('isInvisible')
        .reqMethod('getDeltaMovement')
        .reqMethod('searge:func_96094_a', String) // setCustomName
        .reqMethod('setCustomName', ChatComponent)
        .reqMethod('absMoveTo', double, double, double, float, float)
        .reqMethod('getCustomName')
        .reqField('searge:field_70159_w') // velocity x
        .reqField('searge:field_70181_x') // velocity y
        .reqField('searge:field_70179_y') // velocity z
        .reqField('searge:field_70152_a')
        .reqField('onGround')
        .reqField('id')
        .reqField('ENTITY_COUNTER')
        .reqField('searge:field_70177_z') // yaw
        .reqField('searge:field_70125_A') // pitch
        .reqField('searge:field_70165_t') // locX
        .reqField('searge:field_70163_u') // locY
        .reqField('searge:field_70161_v') // locZ
        .reqField('searge:field_70170_p') // world

    reqClass('net.minecraft.network.chat.Component$Serializer')
        .reqMethod('searge:m_130701_', String)

    reqClass('net.minecraft.core.Rotations')
        .reqConstructor(float, float, float)
        .reqMethod('getX')
        .reqMethod('getY')
        .reqMethod('getZ')

    var PathfinderGoal = reqClass('net.minecraft.world.entity.ai.goal.Goal')

    reqClass('net.minecraft.world.entity.ai.goal.GoalSelector')
        .reqConstructor(Supplier)
        .reqMethod('searge:func_75776_a', int, PathfinderGoal)

    var Level = reqClass('net.minecraft.world.level.Level')
        .reqMethod('getProfilerSupplier')
        .reqMethod('getProfiler')
        .reqField('searge:field_72984_F')

    reqClass('net.minecraft.world.entity.decoration.ArmorStand')
        .reqField('DATA_CLIENT_FLAGS')
        .reqField('DATA_HEAD_POSE')
        .reqConstructor(Level, double, double, double)
        .reqMethod('setSmall', boolean)
        .reqMethod('isSmall')
        .reqMethod('isShowArms')
        .reqMethod('setShowArms', boolean)
        .reqMethod('setNoBasePlate', boolean)
        .reqMethod('isNoBasePlate')
        .reqMethod('setMarker', boolean)
        .reqMethod('isMarker')

    reqClass('net.minecraft.server.level.ServerPlayer')
            .reqField('connection')

    reqClass('net.minecraft.network.protocol.game.ClientboundAnimatePacket')
            .reqField('id')
            .reqField('action')

    reqClass('net.minecraft.network.protocol.game.ClientboundBlockDestructionPacket')
            .reqField('id')
            .reqField('pos')
            .reqField('progress')

    reqClass('net.minecraft.network.protocol.game.ClientboundBlockEventPacket')
            .reqField('pos')
            .reqField('b0')
            .reqField('b1')
            .reqField('block')

    reqClass('net.minecraft.network.protocol.game.ClientboundBlockUpdatePacket')
        .reqField('pos')
        .reqField('blockState')

    reqClass('net.minecraft.network.protocol.game.ClientboundContainerClosePacket')
        .reqField('containerId')

    reqClass('net.minecraft.network.protocol.game.ClientboundPlayerAbilitiesPacket')
        .reqField('invulnerable')
        .reqField('isFlying')
        .reqField('canFly')
        .reqField('instabuild')
        .reqField('flyingSpeed')
        .reqField('walkingSpeed')

    reqClass('net.minecraft.network.protocol.game.ClientboundRemoveEntitiesPacket')
            .reqField('entityIds')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetCameraPacket')
        .reqField('cameraId')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetEntityLinkPacket')
        .reqField('sourceId')
        .reqField('destId')

    reqClass('net.minecraft.core.BlockPos')
        .reqConstructor(double, double, double)

    reqClass('net.minecraft.network.protocol.game.ClientboundTakeItemEntityPacket')
        .reqField('itemId')
        .reqField('playerId')
        .reqField('amount')

    reqClass('net.minecraft.network.protocol.game.ClientboundUpdateMobEffectPacket')
        .reqField('entityId')
        .reqField('effectId')
        .reqField('effectAmplifier')
        .reqField('effectDurationTicks')
        .reqField('flags')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetEquipmentPacket')
        .reqField('entity')
        .reqField('slots')

    reqClass('net.minecraft.network.protocol.game.ClientboundRotateHeadPacket')
        .reqField('entityId')
        .reqField('yHeadRot')

    reqClass('net.minecraft.network.protocol.game.ClientboundMoveEntityPacket')
        .reqField('entityId')
        .reqField('xa')
        .reqField('ya')
        .reqField('za')
        .reqField('yRot')
        .reqField('xRot')
        .reqField('onGround')
        .reqField('hasRot')
        .reqField('hasPos')

    reqClass('net.minecraft.network.protocol.game.ClientboundMoveEntityPacket$Rot')
    reqClass('net.minecraft.network.protocol.game.ClientboundMoveEntityPacket$Pos')
    reqClass('net.minecraft.network.protocol.game.ClientboundMoveEntityPacket$PosRot')

    var EntityDataSerializers = reqClass('net.minecraft.network.syncher.EntityDataSerializers')
    var EntityDataAccessor = reqClass('net.minecraft.network.syncher.EntityDataAccessor')
        .reqConstructor(int, EntityDataSerializers)
        .reqMethod('getId')

    var SynchedEntityData = reqClass('net.minecraft.network.syncher.SynchedEntityData')
        .reqConstructor(Entity)
        .reqMethod('createDataItem', EntityDataAccessor, Object)
        .reqMethod('set', EntityDataAccessor, Object)
        .reqMethod('get', EntityDataAccessor)

    reqClass('net.minecraft.network.protocol.game.ClientboundSetEntityDataPacket')
        .reqConstructor(int, SynchedEntityData, boolean)

    reqClass('net.minecraft.network.protocol.game.ClientboundEntityEventPacket')
        .reqField('entityId')
        .reqField('eventId')

    reqClass('net.minecraft.network.protocol.game.ClientboundTeleportEntityPacket')
        .reqField('id')
        .reqField('x')
        .reqField('y')
        .reqField('z')
        .reqField('yRot')
        .reqField('xRot')
        .reqField('onGround')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetEntityMotionPacket')
        .reqField('id')
        .reqField('xa')
        .reqField('ya')
        .reqField('za')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetExperiencePacket')
        .reqField('experienceProgress')
        .reqField('totalExperience')
        .reqField('experienceLevel')

    reqClass('net.minecraft.network.protocol.game.ClientboundExplodePacket')
        .reqField('x')
        .reqField('y')
        .reqField('z')
        .reqField('power')
        .reqField('toBlow')
        .reqField('knockbackX')
        .reqField('knockbackY')
        .reqField('knockbackZ')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetCarriedItemPacket')
        .reqField('slot')

    reqClass('net.minecraft.network.protocol.game.ClientboundKeepAlivePacket')
        .reqField('id')

    reqClass('net.minecraft.network.protocol.game.ClientboundDisconnectPacket')
        .reqField('reason')

    reqClass('net.minecraft.network.protocol.game.ClientboundAddPlayerPacket')
        .reqField('entityId')
        .reqField('playerId')
        .reqField('x')
        .reqField('y')
        .reqField('z')
        .reqField('yRot')
        .reqField('xRot')
        .reqField('searge:field_148960_i')  // DataWatcher
        .reqField('searge:field_148958_j') // DataWatcher items

    reqClass('net.minecraft.network.protocol.game.ClientboundPlayerInfoPacket')
        .reqField('action')
        .reqField('entries')

    reqClass('net.minecraft.network.protocol.game.ClientboundPlayerInfoPacket$Action')

    reqClass('net.minecraft.world.level.GameType')

    reqClass('net.minecraft.network.protocol.game.ClientboundPlayerInfoPacket$PlayerUpdate')
        .reqField('latency')
        .reqField('gameMode')
        .reqField('profile')
        .reqField('displayName')

    reqClass('net.minecraft.network.protocol.game.ClientboundTabListPacket')
        .reqField('header')
        .reqField('footer')

    reqClass('net.minecraft.network.protocol.game.ClientboundRemoveMobEffectPacket')
        .reqField('entityId')
        .reqField('effect')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetDisplayObjectivePacket')
        .reqField('slot')
        .reqField('objectiveName')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetObjectivePacket')
        .reqField('objectiveName')
        .reqField('displayName')
        .reqField('renderType')
        .reqField('method')

    reqClass('net.minecraft.world.scores.criteria.ObjectiveCriteria$RenderType')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetScorePacket')
        .reqField('owner')
        .reqField('objectiveName')
        .reqField('score')
        .reqField('method')

    reqClass('net.minecraft.server.ServerScoreboard$Method')

    reqClass('net.minecraft.network.protocol.game.ClientboundAddMobPacket')
        .reqField('id')
        .reqField('uuid')
        .reqField('type')
        .reqField('x')
        .reqField('y')
        .reqField('z')
        .reqField('xd')
        .reqField('yd')
        .reqField('zd')
        .reqField('yRot')
        .reqField('xRot')
        .reqField('yHeadRot')
        .reqField('searge:field_149043_l') // DataWatcher

    reqClass('net.minecraft.network.protocol.game.ClientboundAddEntityPacket')
            .reqField('id')
            .reqField('uuid')
            .reqField('type')
            .reqField('x')
            .reqField('y')
            .reqField('z')
            .reqField('xa')
            .reqField('ya')
            .reqField('za')
            .reqField('yRot')
            .reqField('xRot')
            .reqField('data')

    reqClass('net.minecraft.network.protocol.game.ClientboundForgetLevelChunkPacket')
        .reqField('x')
        .reqField('z')

    reqClass('net.minecraft.network.protocol.game.ClientboundSetPlayerTeamPacket')
        .reqField('method')
        .reqField('name')
        .reqField('players')
        .reqField('parameters')
        .reqField('searge:field_149315_g') // flags
        .reqField('searge:field_179816_e') // tag visibility
        .reqField('searge:field_179815_f') // color
        .reqField('searge:field_207509_c') // prefix
        .reqField('searge:field_207510_d') // suffix
        .reqField('searge:field_149318_b') // display name
        .reqField('searge:field_186976_f') // collision rule

    reqClass('net.minecraft.network.protocol.game.ClientboundSetPlayerTeamPacket$Parameters')
        .reqField('displayName')
        .reqField('playerPrefix')
        .reqField('playerSuffix')
        .reqField('nametagVisibility')
        .reqField('collisionRule')
        .reqField('color')
        .reqField('options')

    reqClass('net.minecraft.ChatFormatting')
        .reqField('WHITE')

    reqClass('net.minecraft.network.protocol.game.ServerboundInteractPacket')
        .reqField('entityId')
        .reqField('action')
        .reqField('ATTACK_ACTION')

    reqClass('net.minecraft.network.protocol.game.ServerboundInteractPacket$ActionType')
        .reqField('ATTACK')

    reqClass('net.minecraft.network.syncher.EntityDataSerializers')
        .reqField('BYTE')
        .reqField('INT')
        .reqField('FLOAT')
        .reqField('STRING')
        .reqField('ROTATIONS')
        .reqField('BOOLEAN')

    var Item = reqClass('net.minecraft.world.item.Item')
    Item.reqMethod('getId', Item)

    // new way of getting protocol
    reqClass('net.minecraft.SharedConstants')
        .reqMethod('getProtocolVersion')

    reqClass('net.minecraft.server.MinecraftServer')
        .reqField('status')

    // old way of getting protocol
    reqClass('net.minecraft.network.protocol.status.ServerStatus')
        .reqMethod('getVersion')

    reqClass('net.minecraft.network.protocol.status.ServerStatus$Version')
        .reqMethod('getProtocol')

    var BlockState = reqClass('net.minecraft.world.level.block.state.BlockState')

    reqClass('net.minecraft.world.level.block.Block')
        .reqMethod('getId', BlockState)
        .reqMethod('spigot:fromLegacyData', int)

    reqClass('net.minecraft.network.protocol.PacketFlow')
        .reqEnumField('SERVERBOUND')
        .reqEnumField('CLIENTBOUND')

    reqClass('net.minecraft.network.ConnectionProtocol')
        .reqEnumField('HANDSHAKING')
        .reqEnumField('PLAY')
        .reqEnumField('STATUS')
        .reqEnumField('LOGIN')
        .reqField('flows') // new
        .reqField('mojang:packets:1.14.4') // old

    reqClass('net.minecraft.network.ConnectionProtocol$PacketSet')
        .reqMethod('getId', Class)

    reqClass('net.minecraft.server.network.ServerGamePacketListenerImpl')
        .reqField('connection')

    reqClass('net.minecraft.network.Connection')
        .reqField('channel')

    reqClass('spigot:WorldSettings$EnumGamemode')
}